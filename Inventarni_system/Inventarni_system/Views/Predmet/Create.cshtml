@model Inventarni_system.Models.Predmet

<h2>Přidat nový předmět</h2>

<form id="addPredmetForm">
    @Html.AntiForgeryToken()

    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

    <div>
        <label asp-for="Nazev">Název:</label>
        <input id="Nazev" name="Nazev" required />
        @Html.ValidationMessageFor(m => m.Nazev, "", new { @class = "text-danger" })
    </div>
    <div>
        <label asp-for="SkladId">Sklad:</label>
        <select id="SkladId" name="SkladId" required asp-items="ViewBag.SkladId"></select>
        @Html.ValidationMessageFor(m => m.SkladId, "", new { @class = "text-danger" })
    </div>
    <div>
        <label asp-for="Mnozstvi">Množství:</label>
        <input id="Mnozstvi" name="Mnozstvi" required />
        @Html.ValidationMessageFor(m => m.Mnozstvi, "", new { @class = "text-danger" })
    </div>
    <div>
        <label asp-for="CenaZaKus">Cena za kus:</label>
        <input id="CenaZaKus" name="CenaZaKus" required />
        @Html.ValidationMessageFor(m => m.CenaZaKus, "", new { @class = "text-danger" })
    </div>
    <button type="button" onclick="submitForm()">Přidat</button>
</form>

<script>
    function submitForm() {
        var nazev = document.getElementById("Nazev").value;
        var skladId = document.getElementById("SkladId").value;
        var mnozstvi = document.getElementById("Mnozstvi").value;
        var cenaZaKus = document.getElementById("CenaZaKus").value;

        fetch('/Predmet/Create', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded',
                'X-Requested-With': 'XMLHttpRequest'
            },
            body: new URLSearchParams({
                '__RequestVerificationToken': document.querySelector('input[name="__RequestVerificationToken"]').value,
                'Nazev': nazev,
                'SkladId': skladId,
                'Mnozstvi': mnozstvi,
                'CenaZaKus': cenaZaKus
            })
        })
            .then(response => {
                if (response.ok) {
                    window.location.href = '/Predmet';
                } else {
                    alert('Došlo k chybě při odesílání formuláře.');
                }
            })
            .catch(error => {
                console.error('Chyba:', error);
                alert('Nastala chyba při odesílání formuláře.');
            });
    }
</script>
